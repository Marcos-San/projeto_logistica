{% extends 'log/base.html' %}

{% block title %}InÃ­cio - Sistema de LogÃ­stica{% endblock %}

{% block content %}
<section class="hero">
    <div class="container">
        <div class="hero-content">
            <h1>Bem-vindo ao LogiTrans</h1>
            <p>Rastrear entrega</p>
            <div class="search-box">
                <form action="{% url 'buscar_entrega' %}" method="get" class="form-styled">
                    <div class="form-actions">
                        <input type="text" name="pesquisa" class="search-input" placeholder="Digite o cÃ³digo de rastreamento" required>
                        <button type="submit" class="btn-submit">Consultar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

{% if user.is_authenticated %}
{% if user.is_staff %}
    <section class="features">
        <div class="container">
            <h2>Dashboard RÃ¡pido</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>{{ total_entregas|default:0 }}</h3>
                    <p>Total de Entregas</p>
                </div>
                <div class="stat-card">
                    <h3>{{ entregas_pendentes|default:0 }}</h3>
                    <p>Pendentes</p>
                </div>
                <div class="stat-card">
                    <h3>{{ entregas_em_transito|default:0 }}</h3>
                    <p>Em TrÃ¢nsito</p>
                </div>
                <div class="stat-card">
                    <h3>{{ entregas_entregues|default:0 }}</h3>
                    <p>Entregues</p>
                </div>
                <div class="stat-card">
                    <h3>{{ entregas_sem_rota|default:0 }}</h3>
                    <p>Sem Rota</p>
                </div>
                <div class="stat-card">
                    <h3>{{ motoristas_disponiveis|default:0 }}</h3>
                    <p>Motoristas DisponÃ­veis</p>
                </div>
                <div class="stat-card">
                    <h3>{{ veiculos_disponiveis|default:0 }}</h3>
                    <p>VeÃ­culos DisponÃ­veis</p>
                </div>
                <div class="stat-card">
                    <h3>{{ rotas_ativas|default:0 }}</h3>
                    <p>Rotas Ativas</p>
                </div>
            </div>
        </div>
    </section>
{% endif %}
{% endif %}

<!-- Entregas Recentes -->
{% if entregas_recentes %}
<section class="page-section">
    <div class="container">
        <h2>ğŸ“¦ Ãšltimas Entregas</h2>
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>CÃ³digo</th>
                        <th>Cliente</th>
                        <th>Status</th>
                        <th>Rota</th>
                        <th>Data SolicitaÃ§Ã£o</th>
                        <th>AÃ§Ãµes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for entrega in entregas_recentes %}
                    <tr>
                        <td><strong>{{ entrega.codigo_rastreio }}</strong></td>
                        <td>{{ entrega.cliente.nome }}</td>
                        <td>
                            {% if entrega.status == 'pendente' %}
                                <span class="badge badge-warning">Pendente</span>
                            {% elif entrega.status == 'em_transito' %}
                                <span class="badge badge-info">Em TrÃ¢nsito</span>
                            {% elif entrega.status == 'entregue' %}
                                <span class="badge badge-success">Entregue</span>
                            {% elif entrega.status == 'cancelada' %}
                                <span class="badge badge-danger">Cancelada</span>
                            {% else %}
                                <span class="badge">{{ entrega.get_status_display }}</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if entrega.rota %}
                                <a href="{% url 'lista_entregas' entrega.rota.id %}">{{ entrega.rota.nome }}</a>
                            {% else %}
                                <span class="badge badge-secondary">Sem rota</span>
                            {% endif %}
                        </td>
                        <td>{{ entrega.data_solicitacao|date:"d/m/Y" }}</td>
                        <td>
                            <a href="{% url 'atualizar_entrega' entrega.id %}" class="btn-action btn-edit">Ver</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</section>
{% endif %}

{% if user.is_authenticated %}
{% if user.is_staff %}
<section class="dashboard-preview">
    <div class="container">
        <h2>Recursos do Sistema</h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">ğŸ“¦</div>
                <h3>GestÃ£o de Entregas</h3>
                <p>Controle completo de todas as entregas em tempo real</p>
                <a href="{% url 'list_entrega' %}" class="btn-secondary" style="margin-top: 1rem;">Acessar</a>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ‘¨â€ğŸ’¼</div>
                <h3>Motoristas</h3>
                <p>Cadastro e gerenciamento de equipe de motoristas</p>
                <a href="{% url 'list_motorista' %}" class="btn-secondary" style="margin-top: 1rem;">Acessar</a>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸš›</div>
                <h3>Frota de VeÃ­culos</h3>
                <p>Controle da frota e manutenÃ§Ãµes programadas</p>
                <a href="{% url 'list_veiculo' %}" class="btn-secondary" style="margin-top: 1rem;">Acessar</a>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ—ºï¸</div>
                <h3>Rotas</h3>
                <p>Planejamento e otimizaÃ§Ã£o de rotas de entrega</p>
                <a href="{% url 'list_rota' %}" class="btn-secondary" style="margin-top: 1rem;">Acessar</a>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ‘¤</div>
                <h3>Clientes</h3>
                <p>Cadastro e histÃ³rico de clientes</p>
                <a href="{% url 'list_cliente' %}" class="btn-secondary" style="margin-top: 1rem;">Acessar</a>
            </div>
            <div class="feature-card">
                <div class="feature-icon">ğŸ”</div>
                <h3>Rastreamento</h3>
                <p>Acompanhe entregas em tempo real</p>
                <a href="{% url 'buscar_entrega' %}" class="btn-secondary" style="margin-top: 1rem;">Rastrear</a>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endif %}
{% endblock %}